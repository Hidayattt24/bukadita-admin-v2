{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Documents/KULIAH/Pengabdian Website Posyandu/bukadita_backoffice/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\nexport function middleware(req: NextRequest) {\r\n  const { pathname } = req.nextUrl;\r\n\r\n  // Public routes\r\n  const isPublic =\r\n    pathname === \"/login\" ||\r\n    pathname === \"/register\" ||\r\n    pathname.startsWith(\"/api\");\r\n  if (isPublic) return NextResponse.next();\r\n\r\n  const adminAuth = req.cookies.get(\"admin_auth\")?.value;\r\n  const adminRole = req.cookies.get(\"admin_role\")?.value;\r\n\r\n  // Handle root path: send to login if not authed, otherwise to admin dashboard\r\n  if (pathname === \"/\") {\r\n    const isAuthed = adminAuth === \"1\";\r\n    const isAdminLevel = adminRole === \"admin\" || adminRole === \"superadmin\";\r\n    const url = req.nextUrl.clone();\r\n    if (isAuthed && isAdminLevel) {\r\n      url.pathname = \"/admin/dashboard\";\r\n    } else {\r\n      url.pathname = \"/login\";\r\n    }\r\n    return NextResponse.redirect(url);\r\n  }\r\n\r\n  const isAdminRoute = pathname.startsWith(\"/admin\");\r\n\r\n  // If visiting admin routes, require auth + role admin\r\n  if (isAdminRoute) {\r\n    const isAuthed = adminAuth === \"1\";\r\n    if (!isAuthed) {\r\n      const url = req.nextUrl.clone();\r\n      url.pathname = \"/login\";\r\n      url.searchParams.set(\"redirect\", pathname);\r\n      return NextResponse.redirect(url);\r\n    }\r\n    const isAdminLevel = adminRole === \"admin\" || adminRole === \"superadmin\";\r\n    if (!isAdminLevel) {\r\n      const url = req.nextUrl.clone();\r\n      url.pathname = \"/\";\r\n      return NextResponse.redirect(url);\r\n    }\r\n  }\r\n\r\n  return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/((?!_next|static|favicon.ico|images|public).*)\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAGO,SAAS,WAAW,GAAgB;IACzC,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,gBAAgB;IAChB,MAAM,WACJ,aAAa,YACb,aAAa,eACb,SAAS,UAAU,CAAC;IACtB,IAAI,UAAU,OAAO,+QAAY,CAAC,IAAI;IAEtC,MAAM,YAAY,IAAI,OAAO,CAAC,GAAG,CAAC,eAAe;IACjD,MAAM,YAAY,IAAI,OAAO,CAAC,GAAG,CAAC,eAAe;IAEjD,8EAA8E;IAC9E,IAAI,aAAa,KAAK;QACpB,MAAM,WAAW,cAAc;QAC/B,MAAM,eAAe,cAAc,WAAW,cAAc;QAC5D,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;QAC7B,IAAI,YAAY,cAAc;YAC5B,IAAI,QAAQ,GAAG;QACjB,OAAO;YACL,IAAI,QAAQ,GAAG;QACjB;QACA,OAAO,+QAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,MAAM,eAAe,SAAS,UAAU,CAAC;IAEzC,sDAAsD;IACtD,IAAI,cAAc;QAChB,MAAM,WAAW,cAAc;QAC/B,IAAI,CAAC,UAAU;YACb,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;YAC7B,IAAI,QAAQ,GAAG;YACf,IAAI,YAAY,CAAC,GAAG,CAAC,YAAY;YACjC,OAAO,+QAAY,CAAC,QAAQ,CAAC;QAC/B;QACA,MAAM,eAAe,cAAc,WAAW,cAAc;QAC5D,IAAI,CAAC,cAAc;YACjB,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;YAC7B,IAAI,QAAQ,GAAG;YACf,OAAO,+QAAY,CAAC,QAAQ,CAAC;QAC/B;IACF;IAEA,OAAO,+QAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAkD;AAC9D"}}]
}